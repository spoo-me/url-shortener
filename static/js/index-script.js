function toggleDropdown(){const a=document.querySelector(".dropdown");a.classList.toggle("dropdown-expanded")}const inputBox=document.querySelector("#alias");inputBox&&(inputBox.addEventListener("focus",()=>{document.querySelector(".buttonIn")?.classList.add("focus")}),inputBox.addEventListener("blur",()=>{document.querySelector(".buttonIn")?.classList.remove("focus")}));function get_metrics(){fetch("/metric").then(a=>a.json()).then(a=>{document.querySelector("#total-urls").textContent=a["total-shortlinks"],document.querySelector("#total-clicks").textContent=a["total-clicks"],document.querySelector("#github-stars").textContent=a["github-stars"]}).catch(a=>{console.warn("Failed to load metrics:",a)})}document.onload=get_metrics(),document.addEventListener("DOMContentLoaded",()=>{const a=document.querySelector(".form-section form");a&&a.addEventListener("submit",async b=>{if(b.preventDefault(),"function"==typeof validateURL&&!validateURL())return;if("function"==typeof validatePassword&&!validatePassword())return;const c=document.getElementById("long-url").value.trim(),d=document.getElementById("alias").value.trim(),e=document.getElementById("password").value,f=document.getElementById("max-clicks").value,g=document.getElementById("block-bots").checked,h={long_url:c,alias:d||void 0,password:e||void 0,max_clicks:f?parseInt(f,10):void 0,block_bots:!!g||void 0},i=a.querySelector("button[type=\"submit\"]"),j=i?i.textContent:"";i&&(i.disabled=!0,i.textContent="Shortening...");try{const a=await authFetch("/api/v1/shorten",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(h)}),b=await a.json().catch(()=>({}));if(!a.ok){const a=b&&b.error?b.error:"Failed to shorten URL";return void customTopNotification("ShortenError",a,8,"error")}let c=[];try{c=JSON.parse(localStorage.getItem("recentURLs"))||[]}catch(a){c=[]}c.unshift(b.alias),c=Array.from(new Set(c)).slice(0,3),localStorage.setItem("recentURLs",JSON.stringify(c)),window.location.href=`/result/${encodeURIComponent(b.alias)}`}catch(a){customTopNotification("NetworkError","Network error. Please try again.",8,"error")}finally{i&&(i.disabled=!1,i.textContent=j)}})});